<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: RISC-V ISA Documentation Library Antora Demo Site</title>
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../../_/css/site.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../..">RISC-V ISA Documentation Library Antora Demo Site</a>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="isa" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">ISA Specifications</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">RISC-V ISA Documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Volume I: RISC-V Unprivileged ISA Specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/colophon.html">Preface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rv32.html">RV32I Base Integer Instruction Set</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rv32e.html">RV32E and RV64E Base Integer Instruction Sets, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rv32.html">RV64I Base Integer Instruction Set</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rv128.html">RV128I Base Integer Instruction Set, Version 1.7</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zifencei.html">"Zifencei" Extension for Instruction-Fetch Fence, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zicsr.html">"Zicsr", Extension for Control and Status Register (CSR) Instructions, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/counters.html">"Zicntr" and "Zihpm" Extensions for Counters, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zihintntl.html">"Zihintntl" Extension for Non-Temporal Locality Hints, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zihintpause.html">"Zihintpause" Extension for Pause Hint, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zimop.html">"Zimop" Extension for May-Be-Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zicond.html">"Zicond" Extension for Integer Conditional Operations, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/m-st-ext.html">"M" Extension for Integer Multiplication and Division, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/a-st-ext.html">"A" Extension for Atomic Instructions, Version 2.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zawrs.html">"Zawrs" Extension for Wait-on-Reservation-Set instructions, Version 1.01</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zacas.html">"Zacas" Extension for Atomic Compare-and-Swap (CAS) Instructions, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zabha.html">"Zabha" Extension for Byte and Halfword Atomic Memory Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rvwmo.html">RVWMO Memory Consistency Model, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/ztso-st-ext.html">"Ztso" Extension for Total Store Ordering, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/cmo.html">"CMO" Extensions for Base Cache Management Operation ISA, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/f-st-ext.html">"F" Extension for Single-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/d-st-ext.html">"D" Extension for Double-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/q-st-ext.html">"Q" Extension for Quad-Precision Floating-Point, Version 2.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zfh.html">"Zfh" and "Zfhmin" Extensions for Half-Precision Floating-Point, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/bfloat16.html">"BF16" Extensions for for BFloat16-precision Floating-Point, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zfa.html">"Zfa" Extension for Additional Floating-Point Instructions, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zfinx.html">"Zfinx", "Zdinx", "Zhinx", "Zhinxmin" Extensions for Floating-Point in Integer Registers, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/c-st-ext.html">"C" Extension for Compressed Instructions, Version 2.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/zc.html">"Zc*" Extension for Code Size Reduction, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/b-st-ext.html">"B" Extension for Bit Manipulation, Version 1.0.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/p-st-ext.html">"P" Extension for Packed-SIMD Instructions, Version 0.2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/v-st-ext.html">"V" Standard Extension for Vector Operations, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/scalar-crypto.html">Cryptography Extensions: Scalar &amp; Entropy Source Instructions, Version 1.0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/vector-crypto.html">Cryptography Extensions: Vector Instructions, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/unpriv-cfi.html">Control-flow Integrity (CFI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/rv-32-64g.html">RV32/64G Instruction Set Listings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/extending.html">Extending RISC-V</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/naming.html">ISA Extension Naming Conventions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/history.html">History and Acknowledgments</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/mm-eplan.html">Appendix A: RVWMO Explanatory Material, Version 0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/mm-formal.html">Appendix B: Formal Memory Model Specifications, Version 0.1</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/vector-examples.html">Appendix C: Vector Assembly Code Examples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../unpriv/calling-convention.html">Appendix D: Calling Convention for Vector State (Not authoritative - Placeholder Only)</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Volume II: RISC-V Privileged ISA Specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="priv-intro.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="priv-csrs.html">Control and Status Registers (CSRs)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="machine.html">Machine-Level ISA, Version 1.13</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="indirect-csr.html">"Smcsrind/Sscsrind" Indirect CSR Access, version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="smcntrpmf.html">"Smcntrpmf" Cycke and Instret Privilege Mode Filtering, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rnmi.html">"Smrnmi" Extension for Resumable Non-Maskable Interrupts, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="smcdeleg.html">"Smcdeleg" Counter Delegation Extension, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="hypervisor.html">"H" Extension for Hypervisor Support, Version 1.0</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="priv-cfi.html">Control-flow Integrity(CFI)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="priv-insns.html">RISC-V Privileged Instruction Set Listings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="priv-history.html">History</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="bibliography.html">Bibliography</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">ISA Specifications</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">ISA Specifications</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../riscv-library/1/index.html">RISC-V Documentation Library</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../riscv-library/1/index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../riscv-library/1/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">ISA Specifications</a></li>
    <li>Volume II: RISC-V Privileged ISA Specification</li>
    <li><a href="indirect-csr.html">"Smcsrind/Sscsrind" Indirect CSR Access, version 1.0</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/riscv/riscv-isa-manual/edit/antora-refactor/modules/priv/pages/indirect-csr.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="indirect-csr"><a class="anchor" href="#indirect-csr"></a>"Smcsrind/Sscsrind" Indirect CSR Access, Version 1.0</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction"><a class="anchor" href="#_introduction"></a>Introduction</h3>
<div class="paragraph">
<p>Smcsrind/Sscsrind is an ISA extension that extends the indirect CSR
access mechanism originally defined as part of the
<a href="https://github.com/riscv/riscv-aia"><span class="underline">Smaia/Ssaia
extensions</span></a>, in order to make it available for use by other extensions
without creating an unnecessary dependence on Smaia/Ssaia.</p>
</div>
<div class="paragraph">
<p>This extension confers two benefits:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It provides a means to access an array of registers via CSRs without
requiring allocation of large chunks of the limited CSR address space.</p>
</li>
<li>
<p>It enables software to access each of an array of registers by index,
without requiring a switch statement with a case for each register.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>CSRs are accessed indirectly via this extension using select values, in
contrast to being accessed directly using standard CSR numbers. A CSR
accessible via one method may or may not be accessible via the other
method. Select values are a separate address space from CSR numbers, and
from tselect values in the Sdtrig extension. If a CSR is both directly
and indirectly accessible, the CSR&#8217;s select value is unrelated to its
CSR number.</p>
</div>
<div class="paragraph">
<p>Further, Machine-level and Supervisor-level select values are separate
address spaces from each other; however, Machine-level and
Supervisor-level CSRs with the same select value may be defined by an
extension as partial or full aliases with respect to each other. This
typically would be done for CSRs that can be delegated from
Machine-level to Supervisor-level.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The machine-level extension <strong>Smcsrind</strong> encompasses all added CSRs and
all behavior modifications for a hart, over all privilege levels. For a
supervisor-level environment, extension <strong>Sscsrind</strong> is essentially the
same as Smcsrind except excluding the machine-level CSRs and behavior
not directly visible to supervisor level.</p>
</div>
</div>
<div class="sect2">
<h3 id="body"><a class="anchor" href="#body"></a>Machine-level CSRs</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 15%;">
<col style="width: 46%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Number</strong></th>
<th class="tableblock halign-left valign-top"><strong>Privilege</strong></th>
<th class="tableblock halign-left valign-top"><strong>Width</strong></th>
<th class="tableblock halign-left valign-top"><strong>Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x350</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>miselect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register select</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x351</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x352</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x353</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x355</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x356</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias 5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x357</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mireg6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Machine indirect register alias 6</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>mireg*</code> CSR numbers are not consecutive because miph is CSR number
0x354.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The CSRs listed in the table above provide a window for accessing
register state indirectly. The value of <code>miselect</code> determines which
register is accessed upon read or write of each of the machine indirect alias
CSRs (<code>mireg*</code>). <code>miselect</code> value ranges are allocated to dependent
extensions, which specify the register state accessible via each
<code>mireg<em>i</em></code> register, for each <code>miselect</code> value. <code>miselect</code> is a WARL
register.</p>
</div>
<div class="paragraph">
<p>The <code>miselect</code> register implements at least enough bits to support all
implemented <code>miselect</code> values (corresponding to the implemented extensions
that utilize <code>miselect</code>/<code>mireg*</code> to indirectly access register state). The
<code>miselect</code> register may be read-only zero if there are no extensions
implemented that utilize it.</p>
</div>
<div class="paragraph">
<p>Values of <code>miselect</code> with the most-significant bit set (bit XLEN - 1 = 1)
are designated only for custom use, presumably for accessing custom
registers through the alias CSRs. Values of <code>miselect</code> with the
most-significant bit clear are designated only for standard use and are
reserved until allocated to a standard architecture extension. If XLEN
is changed, the most-significant bit of <code>miselect</code> moves to the new
position, retaining its value from before.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An implementation is not required to support any custom values for
<code>miselect</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The behavior upon accessing <code>mireg*</code> from M-mode, while <code>miselect</code> holds a
value that is not implemented, is UNSPECIFIED.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is expected that implementations will typically raise an illegal
instruction exception for such accesses, so that, for example, they can
be identified as software bugs. Platform specs, profile specs, and/or
the Privileged ISA spec may place more restrictions on behavior for such
accesses.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Attempts to access <code>mireg*</code> while <code>miselect</code> holds a number in an allocated
and implemented range results in a specific behavior that, for each
combination of <code>miselect</code> and <code>mireg<em>i</em></code>, is defined by the extension to
which the <code>miselect</code> value is allocated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ordinarily, each <code>mireg</code><strong><em>i</em></strong> will access register state, access
read-only 0 state, or raise an illegal instruction exception.</p>
</div>
<div class="paragraph">
<p>For RV32, if an extension defines an indirectly accessed register as 64 bits wide, it is recommended that the lower 32 bits of the register are accessed through one of <code>mireg</code>, <code>mireg2</code>, or <code>mireg3</code>, while the upper 32 bits are accessed through <code>mireg4</code>, <code>mireg5</code>, or <code>mireg6</code>, respectively.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Six <code>*ireg*</code> registers are defined in order to ensure that the needs of extensions in development are covered, with some room for growth.  For example, for an <code>siselect</code> value associated with counter X, <code>sireg</code>/<code>sireg2</code> could be used to access <code>mhpmcounterX</code>/<code>mhpmeventX</code>, while <code>sireg4</code>/<code>sireg5</code> could access <code>mhpmcounterXh</code>/<code>mhpmeventXh</code>. Six <code>*ireg*</code> registers allows for accessing up to 3 CSR arrays per index (<code>*iselect</code>) with RV32-only CSRs, or up to 6 CSR arrays per index value without RV32-only CSRs.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_supervisor_level_csrs"><a class="anchor" href="#_supervisor_level_csrs"></a>Supervisor-level CSRs</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 15%;">
<col style="width: 46%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Number</strong></th>
<th class="tableblock halign-left valign-top"><strong>Privilege</strong></th>
<th class="tableblock halign-left valign-top"><strong>Width</strong></th>
<th class="tableblock halign-left valign-top"><strong>Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x150</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>siselect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register select</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x151</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x152</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x153</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x155</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x156</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias 5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x157</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sireg6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supervisor indirect register alias 6</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The CSRs in the table above are required if S-mode is implemented.</p>
</div>
<div class="paragraph">
<p>The <code>siselect</code> register will support the value range 0..0xFFF at a
minimum. A future extension may define a value range outside of this
minimum range. Only if such an extension is implemented will <code>siselect</code> be
required to support larger values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Requiring a range of 0–0xFFF for <code>siselect</code>, even though most or
all of the space may be reserved or inaccessible, permits M-mode to
emulate indirectly accessed registers in this implemented range,
including registers that may be standardized in the future.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Values of <code>siselect</code> with the most-significant bit set (bit XLEN - 1 = 1)
are designated only for custom use, presumably for accessing custom registers through the alias
CSRs. Values of <code>siselect</code> with the most-significant bit clear are
designated only for standard use and are reserved until allocated to a
standard architecture extension. If XLEN is changed, the
most-significant bit of <code>siselect</code> moves to the new position, retaining
its value from before.</p>
</div>
<div class="paragraph">
<p>The behavior upon accessing <code>sireg*</code> from M-mode or S-mode, while <code>siselect</code>
holds a value that is not implemented at supervisor level, is UNSPECIFIED.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended that implementations raise an illegal instruction
exception for such accesses, to facilitate possible emulation (by
M-mode) of these accesses.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An extension is considered not to be implemented at supervisor level if
machine level has disabled the extension for S-mode, such as by the
settings of certain fields in CSR <code>menvcfg</code>, for example.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Otherwise, attempts to access <code>sireg*</code> from M-mode or S-mode while
<code>siselect</code> holds a number in a standard-defined and implemented range
result in specific behavior that, for each combination of <code>siselect</code> and
<code>sireg<em>i</em></code>, is defined by the extension to which the <code>siselect</code> value is
allocated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ordinarily, each <code>sireg</code><strong><em>i</em></strong> will access register state, access
read-only 0 state, or, unless executing in a virtual machine (covered in
the next section), raise an illegal instruction exception.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that the widths of <code>siselect</code> and <code>sireg*</code> are always the
current XLEN rather than SXLEN. Hence, for example, if MXLEN = 64 and
SXLEN = 32, then these registers are 64 bits when the current privilege
mode is M (running RV64 code) but 32 bits when the privilege mode is S
(RV32 code).</p>
</div>
</div>
<div class="sect2">
<h3 id="_virtual_supervisor_level_csrs"><a class="anchor" href="#_virtual_supervisor_level_csrs"></a>Virtual Supervisor-level CSRs</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 15%;">
<col style="width: 12%;">
<col style="width: 12%;">
<col style="width: 15%;">
<col style="width: 46%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Number</strong></th>
<th class="tableblock halign-left valign-top"><strong>Privilege</strong></th>
<th class="tableblock halign-left valign-top"><strong>Width</strong></th>
<th class="tableblock halign-left valign-top"><strong>Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x250</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsiselect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register
select</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x251</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x252</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x253</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg3</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias 3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x255</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg4</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias 4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias 5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x257</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HRW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vsireg6</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual supervisor indirect register alias 6</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The CSRs in the table above are required if the hypervisor extension is
implemented. These VS CSRs all match supervisor CSRs, and substitute for
those supervisor CSRs when executing in a virtual machine (in VS-mode or
VU-mode).</p>
</div>
<div class="paragraph">
<p>The <code>vsiselect</code> register will support the value range 0..0xFFF at a
minimum. A future extension may define a value range outside of this
minimum range. Only if such an extension is implemented will <code>vsiselect</code>
be required to support larger values.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Requiring a range of 0–0xFFF for <code>vsiselect</code>, even though most or all of
the space may be reserved or inaccessible, permits a hypervisor to
emulate indirectly accessed registers in this implemented range,
including registers that may be standardized in the future.</p>
</div>
<div class="paragraph">
<p>More generally it is recommended that <code>vsiselect</code> and <code>siselect</code> be
implemented with the same number of bits. This also avoids creation of a
virtualization hole due to observable differences between <code>vsiselect</code> and
<code>siselect</code> widths.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Values of <code>vsiselect</code> with the most-significant bit set (bit XLEN - 1 = 1)
are designated only for custom use, presumably for accessing custom registers through the alias
CSRs. Values of <code>vsiselect</code> with the most-significant bit clear are
designated only for standard use and are reserved until allocated to a
standard architecture extension. If XLEN is changed, the
most-significant bit of <code>vsiselect</code> moves to the new position, retaining
its value from before.</p>
</div>
<div class="paragraph">
<p>For alias CSRs <code>sireg*</code> and <code>vsireg*</code>, the hypervisor extension’s usual
rules for when to raise a virtual instruction exception (based on
whether an instruction is HS-qualified) are not applicable. The
rules given in this section for <code>sireg</code> and <code>vsireg</code> apply instead, unless
overridden by the requirements specified in the section below, which
take precedence over this section when extension Smstateen is also
implemented.</p>
</div>
<div class="paragraph">
<p>A virtual instruction exception is raised for attempts from VS-mode or VU-mode to directly access <code>vsiselect</code> or <code>vsireg*</code>, or attempts from VU-mode to access <code>siselect</code> or <code>sireg*</code>.</p>
</div>
<div class="paragraph">
<p>The behavior upon accessing <code>vsireg*</code> from M-mode or HS-mode, or accessing <code>sireg*</code> (really <code>vsireg*</code>) from VS-mode, while <code>vsiselect</code> holds a value that is not implemented at HS level, is UNSPECIFIED.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is recommended that implementations raise an illegal instruction exception for such accesses, to facilitate possible emulation (by M-mode) of these accesses.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Otherwise, while <code>vsiselect</code> holds a number in a standard-defined and
implemented range, attempts to access <code>vsireg*</code> from a sufficiently
privileged mode, or to access <code>sireg*</code> (really <code>vsireg*</code>) from VS-mode,
result in specific behavior that, for each combination of <code>vsiselect</code> and
<code>vsireg<em>i</em></code>, is defined by the extension to which the <code>vsiselect</code> value is
allocated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ordinarily, each <code>vsireg</code><strong><em>i</em></strong> will access register state, access read-only 0 state, or raise an exception (either an illegal instruction exception or, for select accesses from VS-mode, a virtual instruction exception).  When <code>vsiselect</code> holds a value that is implemented at HS level but not at VS level, attempts to access <code>sireg*</code> (really <code>vsireg*</code>) from VS-mode will typically raise a virtual instruction exception.  But there may be cases specific to an extension where different behavior is more appropriate.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Like <code>siselect</code> and <code>sireg*</code>, the widths of <code>vsiselect</code> and <code>vsireg*</code> are always
the current XLEN rather than VSXLEN. Hence, for example, if HSXLEN = 64
and VSXLEN = 32, then these registers are 64 bits when accessed by a
hypervisor in HS-mode (running RV64 code) but 32 bits for a guest OS in
VS-mode (RV32 code).</p>
</div>
</div>
<div class="sect2">
<h3 id="_access_control_by_the_state_enable_csrs"><a class="anchor" href="#_access_control_by_the_state_enable_csrs"></a>Access control by the state-enable CSRs</h3>
<div class="paragraph">
<p>If extension Smstateen is implemented together with Smcsrind, bit 60 of
state-enable register <code>mstateen0</code> controls access to <code>siselect</code>, <code>sireg*</code>,
<code>vsiselect</code>, and <code>vsireg*</code>. When <code>mstateen0</code>[60]=0, an attempt to access one
of these CSRs from a privilege mode less privileged than M-mode results
in an illegal instruction exception. As always, the state-enable CSRs do
not affect the accessibility of any state when in M-mode, only in less
privileged modes. For more explanation, see the documentation for
extension
<a href="https://github.com/riscv/riscv-state-enable/releases/download/v1.0.0/Smstateen.pdf"><span class="underline">Smstateen</span></a>.</p>
</div>
<div class="paragraph">
<p>Other extensions may specify that certain mstateen bits control access
to registers accessed indirectly through <code>siselect</code> + <code>sireg*</code>, and/or
<code>vsiselect</code> + <code>vsireg*</code>. However, regardless of any other mstateen bits, if
<code>mstateen0</code>[60] = 1, a virtual instruction exception is raised as
described in the previous section for all attempts from VS-mode or
VU-mode to directly access <code>vsiselect</code> or <code>vsireg*</code>, and for all attempts
from VU-mode to access <code>siselect</code> or <code>sireg*</code>.</p>
</div>
<div class="paragraph">
<p>If the hypervisor extension is implemented, the same bit is defined also
in hypervisor CSR <code>hstateen0</code>, but controls access to only <code>siselect</code> and <code>sireg*</code>
(really <code>vsiselect</code> and <code>vsireg*</code>), which is the state potentially
accessible to a virtual machine executing in VS or VU-mode. When
<code>hstateen0</code>[60]=0 and <code>mstateen0</code>[60]=1, all attempts from VS or VU-mode to
access <code>siselect</code> or <code>sireg*</code> raise a virtual instruction exception, not an
illegal instruction exception, regardless of the value of <code>vsiselect</code> or
any other mstateen bit.</p>
</div>
<div class="paragraph">
<p>Extension Ssstateen is defined as the supervisor-level view of
Smstateen. Therefore, the combination of Sscsrind and Ssstateen
incorporates the bit defined above for <code>hstateen0</code> but not that for
<code>mstateen0</code>, since machine-level CSRs are not visible to supervisor level.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>CSR address space is reserved for a possible future "Sucsrind" extension that extends indirect CSR access to user mode.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
